**Challenge:** n0s4n1ty 1

**Level:** Easy

**Challenge Author:** Prince Niyonshuti N.

### Description
A developer has added profile picture upload functionality to a website. 
However, the implementation is flawed, and it presents an opportunity for you. 
Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. 
Your ultimate goal is to find the hidden flag located in the /root directory.

### Step-by-Step Walkthrough

First, the description tells us that the upload function has a vulnerability. 

Reviewing some common exploitation techniques from [here](https://medium.com/@red.whisperer/5-advanced-ways-i-test-for-file-upload-vulnerabilities-5b01358f87d1), We first check our PHP vulnerabilities. 

To use the PHP vulnerability scanner, just upload the file: [phpVulnerabilityScan.php](http://github.com/Texas-Tim/CyberSecurityPractice/blob/main/PicoCTF/n0s4n1ty%201%20%E2%80%94%20Web%20Exploitation%20%E2%80%94%20picoCTF%202025/phpVulnerabilityScan.php)

Using the websites file uploader. It doesn't seem to check for valid files and lets us upload anything!

Looks like there's a lot of vulnerabilities from our list! So we can stop reading the article and just use PHP to try and identify the root folder. I found a script that lets me take advantage of the "System" vulnerability we identified and allows me to insert a unix command. Upload the file: [ShellScript.php](https://github.com/Texas-Tim/CyberSecurityPractice/blob/main/PicoCTF/n0s4n1ty%201%20%E2%80%94%20Web%20Exploitation%20%E2%80%94%20picoCTF%202025/ShellScript.php)

Now I can traverse the trajectory. But, just to see how much of a vulnerability this truly is, let's try a few scoping commands first.

In order to run any php commands using our uploaded shell script file, attach uploads/ShellScript.php to the URL, then append ```?cmd=<command>``` for a url that looks like 

`http://standard-pizzas.picoctf.net:<random_number>/uploads/ShellScript.php?cmd=<command>`

Use the command: ```sudo -l``` (this lists the commands that the current user is allowed to execute with sudo privileges)

From this command, we can see two things. 
1. The user we are logged in as is called: www-data
2. The user "www-data" does not require a password to use sudo for any commands (that's what the "(ALL) NOPASSWD: ALL" means)

From here, we can simply run ```sudo ls /root``` to get the name of the flag file, then run ```sudo cat /root/flag.txt``` to grab the flag! 
